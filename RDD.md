# **要件定義書：DreamWeave**

## 1. 概要

**目的**
ユーザーが見た夢を起床直後に音声で記録し，AIが物語化・構造化することで，
「自分だけの夢世界」を可視化・共有する体験を提供するスマホアプリ。

**開発方針**

* MVP段階：夢記録・音声入力・要約生成
* 拡張段階：夢世界マップ・類似夢リンク・他者接続

**対象ユーザー**
夢をよく見る・創作志向の強いユーザー／日記や内省を好む層

---

## 2. コアコンセプト

* **記録の必然性**：目覚まし後に音声で夢を話す→スヌーズ解除
* **物語化**：LLMが断片的な記録を整理し，短いナラティブを生成
* **世界化**：夢内の登場人物・場所・感情をノード化し，夢世界を構築
* **共有化**：類似する夢をもつ他者の世界と匿名的にリンク

---

## 3. 機能要件

### 3.1 睡眠・アラーム関連

| ID  | 機能     | 詳細                                   |
| --- | ------ | ------------------------------------ |
| F-1 | アラーム設定 | 就寝前に時刻・アラーム音を設定                      |
| F-2 | 起床トリガ  | アラーム鳴動後、音声入力を行わないと停止できない（設定でON/OFF可） |
| F-3 | 睡眠ログ連携 | iOSヘルスケア／Wearデバイス連携。体動・心拍から睡眠段階を推定   |

---

### 3.2 夢記録・対話入力

| ID  | 機能     | 詳細                                 |
| --- | ------ | ---------------------------------- |
| F-4 | 音声入力   | Whisper APIでリアルタイム認識。テキスト化して保存     |
| F-5 | 会話補助   | LLMが夢想起の質問を投げかける（例：「どんな場所にいましたか？」） |
| F-6 | 編集機能   | テキスト化された内容を手動修正可                   |
| F-7 | 自動タグ付け | LLMが登場人物・場所・感情を抽出しタグ生成             |
| F-8 | 夢日記生成  | LLMが物語調テキストを生成（300〜500字程度）         |

---

### 3.3 夢世界構築（拡張段階）

| ID   | 機能      | 詳細                           |
| ---- | ------- | ---------------------------- |
| F-9  | 夢マップ表示  | ノード（人物・場所・モチーフ）とエッジ（関連夢）を可視化 |
| F-10 | 類似夢探索   | 他人の夢データと類似タグをマッチングし表示        |
| F-11 | 感情可視化   | 夢ごとに感情トーンを色で表示（例：恐怖＝赤）       |
| F-12 | 時系列ブラウズ | 夢の連続性を時間軸で表示                 |
| F-13 | 夢テーマ設定  | 就寝前に「今日見たいテーマ」を入力→翌夢との関係解析   |

---

### 3.4 共有・社会機能（後期拡張）

| ID   | 機能      | 詳細                                  |
| ---- | ------- | ----------------------------------- |
| F-14 | 匿名共有    | 他者の夢ノードと自動リンク（キーワード一致）              |
| F-15 | 世界間トンネル | 「あなたの“青い部屋”と誰かの“青い海”が繋がっています」など詩的通知 |
| F-16 | コミュニティ  | 任意で夢を公開・コメント可能（後期リリース）              |

---

### 3.5 マイページ／履歴管理

| ID   | 機能     | 詳細                 |
| ---- | ------ | ------------------ |
| F-17 | 夢リスト表示 | 日付順に記録閲覧           |
| F-18 | 絞り込み検索 | タグ・感情・登場人物などで検索    |
| F-19 | 統計分析   | 夢頻度・感情分布・登場回数など可視化 |

---

### 3.6 プレミアム機能

| ID   | 機能        | 詳細                 |
| ---- | --------- | ------------------ |
| F-20 | 3D夢マップ    | WebGL表示で夢世界を空間的に探索 |
| F-21 | 感情分析レポート  | 長期的トレンドをAI要約       |
| F-22 | 音声保存      | 元音声をクラウド保存／再生      |
| F-23 | テーマ別レコメンド | 類似テーマ夢をAIが提案       |

---

## 4. 非機能要件

| 項目       | 内容                             |
| -------- | ------------------------------ |
| 対応OS     | iOS / Android                  |
| フロントエンド  | Flutter                        |
| バックエンド   | FastAPI                        |
| データベース   | Supabase（PostgreSQL + Storage） |
| AI連携     | OpenAI Whisper / GPT-4o-mini   |
| マップ描画    | WebView (D3.js or Force-Graph) |
| セキュリティ   | Supabase Auth (email/OAuth)    |
| スケーラビリティ | 将来はユーザー10万規模を想定                |

---

## 5. 画面設計（概要）

1. **起床画面**：アラーム停止→音声入力開始
2. **夢記録画面**：AIとの簡易対話→自動要約→保存
3. **夢リスト画面**：日付・タイトル表示
4. **夢詳細画面**：物語テキスト＋タグ＋関連ノード
5. **夢マップ画面**：ノードリンク可視化
6. **設定画面**：テーマ・通知・アカウント・プレミアム登録

---

## 6. ユーザーフロー

1. 就寝前にテーマ設定
2. 起床時にアラーム→音声入力で夢記録
3. LLMが対話で内容を補完・整形
4. 夢日記自動生成→保存
5. 過去の夢を閲覧／夢マップで関係を探索
6. 類似夢があると通知→他人の夢とリンク

---

## 7. MVPスコープ

* F-1〜F-8, F-17, F-18
* Whisper連携＋LLM要約
* シンプルな夢リスト表示まで
  → 1か月開発想定

---

## 8. 将来拡張（ロードマップ）

| フェーズ | 主な追加要素              |
| ---- | ------------------- |
| v1.0 | MVPリリース（音声記録＋夢日記生成） |
| v1.1 | 睡眠センサ連携＋感情タグ        |
| v1.2 | 夢マップ自動生成（D3.js）     |
| v1.3 | 類似夢マッチング（他者リンク）     |
| v2.0 | 3D夢世界＋匿名コミュニティ      |

---

## 9. 収益化モデル

* 無料：夢記録＋AI要約（月30件まで）
* 有料（月¥480〜）：無制限記録＋夢マップ＋感情分析＋音声保存
* 将来的に「夢テーマ課金（AI生成）」も展開可

---

## 10. ビジョン

日常では失われる「無意識の断片」を，
物語として再構築し，
個人と他者の潜在世界をゆるやかに繋ぐ。
**“夢を記録する”ことが，創造的自己発見になるアプリ。**

---
